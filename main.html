<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        html,
        body {
            height: 100%;
            margin: 0;
            padding: 0;
            color: #ccc
        }

        body {
            width: 100%;
            min-height: 100vh;
            margin: 0;
            padding: 0;
            background-image: url('../images/main_page.jpg');
            background-position: center;
            background-repeat: no-repeat;
            background-size: cover;
            background-color: aquamarine;

        }

        .contaner {
            width: 100%;
            min-height: 90vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .contaner1 {
            width: 90%;
            max-width: 420px;
            min-width: 220px;
            box-shadow: 0px 0px 32px 0 #FBC02D;
            border: 3px solid #363333;
            border-radius: 20px;
            background-color: #070707ba;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 24px 12px;
            box-sizing: border-box
        }

        h1 {

            font-size: 25px;
        }

        .option {
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            align-content: center;

        }

        .option button {
            color: white;
            margin: 20px 0;
            width: 325px;
            height: 40px;
            font-size: 21px;
            font-weight: bold;
            font-family: sans-serif;
            border-radius: 8px;
            box-shadow: #494848 0px 0px 0px 3px;
            border: none;
            background: #fdd835f2;
            cursor: pointer;
        }

        .option button a {
            text-decoration: none;
            color: inherit;
            /* display: block; */
            width: 100%;
            height: 100%;
            align-items: center;
            display: flex;
            justify-content: center;
        }

        .option button a img {
            width: 30px;
            height: 30px;
            margin-left: 12px;
            object-fit: contain;
            display: inline-block;
        }

        .option button a:hover img {
            animation: bounceY 0.5s ease-in-out;
        }

        @keyframes bounceY {
            0% {
                transform: translateY(0);
            }

            30% {
                transform: translateY(-12px);
            }

            50% {
                transform: translate(0);
            }

            70% {
                transform: translateY(-6px);
            }

            100% {
                transform: translateY(0);
            }
        }

        .navbar {
            width: 100%;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
            box-sizing: border-box;
        }

        .navbar .logo img {
            width: 50px;
            height: 50px;
            object-fit: contain;
        }

        .navbar nav {
            display: flex;
            align-items: center;

        }

        .navbar nav li {
            list-style: none;

        }

        .navbar nav li a {
            display: flex;
            align-content: center;
            align-items: center;
            padding: 4px 30px;
            /* border: 2px solid white; */
            color: white;
            text-decoration: none;
            margin: 0px 20px;
            font-size: 25px;
            font-weight: bold;
            box-shadow: inset #393a3a 0px 0px 0px 4px;
            background-color: #070707c4;
            border-radius: 25px;
        }

        .logo h3 {
            font-size: 23px;
            font-weight: bold;
            color: white;

        }

        .logo h3 span {
            color: #fdd835;
            font-size: 25px;
            font-weight: bold;
        }

        /* Add this to your <style> section */

        /* // Optional: Add a semi-transparent overlay effect */
        /* Overlay effect for login and signup containers */
        #login-container,
        #signup-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            min-height: 100vh;
            /* background: rgba(0,0,0,0.4); dark overlay */
            z-index: 1000;
            display: none;
            /* Hidden by default, shown with JS */
            align-items: center;
            justify-content: center;
        }

        /* Style for the inner box */
        #login-container .contaner1,
        #signup-container .contaner1 {
            /* background: #222c; /* slightly more opaque for focus */
            box-shadow: 0px 0px 32px 0 #FBC02D;
            border: 4px solid #72727285
        }

        .lo-form {
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;

        }

        .lo-form input {
            margin: 10px 0px;
        }
    </style>
</head>

<body>
    <header>
        <div class="navbar">
            <div class="logo">
                <h3><span>H</span>TM</h3>
            </div>
            <nav>
                <li><a href="#" id="login-link">login</a></li>
                <!-- <li><a href="#">sign in</a></li> -->
            </nav>
        </div>
    </header>
    <div class="contaner">
        <div class="contaner1">
            <h1>Hotel manegment system</h1>
            <div class="option">
                <button><a href="customer.html">On Table<img src="../images/menu.png" alt=""></a></button>
                <button><a href="kitchen.html">In Kitchen<img src="../images/kitchen (1).png" alt=""></a></button>
                <button><a href="counter.html">On Counter<img src="../images/restaurant.png" alt=""></a></button>
                <button><a href="admin.html">Admin Edit<img src="../images/admin.png" alt=""></a></button>
            </div>
        </div>
    </div>

    <!-- Place these just after your main .contaner div -->
    <div id="login-container" class="contaner" style="display:none;">
        <div class="contaner1">
            <h1>Login</h1>
            <form class="lo-form">
                <input type="text" placeholder="Username">
                <input type="password" placeholder="Password">
                <button type="submit">Login</button>
            </form>
            <p style="color:#fff;">Don't have an account? <a href="#" id="show-signup">Sign Up</a></p>
            <button id="close-login">Back</button>
        </div>
    </div>

    <div id="signup-container" class="contaner">
        <div class="contaner1">
            <h1>Sign Up</h1>
            <form class="lo-form">
                <input type="text" placeholder="Username">
                <input type="password" placeholder="Password">
                <button type="submit">Sign Up</button>
            </form>
            <p>Already have an account? <a href="#" id="show-login">Login</a></p>
            <button id="close-signup">Back</button>
        </div>
    </div>



</body>
<script>
    // Show login container
    document.querySelector('.navbar nav li a').addEventListener('click', function (e) {
        e.preventDefault();
        document.querySelector('.contaner').style.display = 'none';
        document.getElementById('login-container').style.display = 'flex';
        document.getElementById('signup-container').style.display = 'none';
    });
    // Back from login
    document.getElementById('close-login').onclick = function () {
        document.querySelector('.contaner').style.display = 'flex';
        document.getElementById('login-container').style.display = 'none';
    };
    // Show signup from login
    document.getElementById('show-signup').onclick = function (e) {
        e.preventDefault();
        document.getElementById('login-container').style.display = 'none';
        document.getElementById('signup-container').style.display = 'flex';
    };
    // Back from signup
    document.getElementById('close-signup').onclick = function () {
        document.querySelector('.contaner').style.display = 'flex';
        document.getElementById('signup-container').style.display = 'none';
    };
    // Show login from signup
    document.getElementById('show-login').onclick = function (e) {
        e.preventDefault();
        document.getElementById('signup-container').style.display = 'none';
        document.getElementById('login-container').style.display = 'flex';
    };
</script>
<!-- Replace the login/signup scripts in main.html with this: -->
<script>
    // üîÅ Signup Form Handler
    document.querySelector("#signup-container form").addEventListener("submit", function (e) {
        e.preventDefault();
        const username = e.target[0].value.trim();
        const password = e.target[1].value.trim();

        if (!username || !password) {
            alert("Please fill in both fields");
            return;
        }

        fetch("http://localhost:3000/signup", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            credentials: "include", // ‚úÖ Important for sessions
            body: JSON.stringify({ username, password })
        })
        .then(response => response.json())
        .then(data => {
            alert(data.message || data.error);
            if (!data.error) {
                // Clear form and show login
                e.target.reset();
                document.getElementById('signup-container').style.display = 'none';
                document.getElementById('login-container').style.display = 'flex';
            }
        })
        .catch(err => {
            console.error("Signup Error:", err);
            alert("Signup failed. Please try again.");
        });
    });

    // üîÅ Login Form Handler
    document.querySelector("#login-container form").addEventListener("submit", function (e) {
        e.preventDefault();
        const username = e.target[0].value.trim();
        const password = e.target[1].value.trim();

        if (!username || !password) {
            alert("Please fill in both fields");
            return;
        }

        fetch("http://localhost:3000/login", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            credentials: "include" // ‚úÖ Essential for sessions
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                alert("Login successful!");
                updateNavbar(); // ‚úÖ Update UI
                // Close login modal
                document.querySelector('.contaner').style.display = 'flex';
                document.getElementById('login-container').style.display = 'none';
                // Clear form
                e.target.reset();
            } else {
                alert(data.message || "Login failed");
            }
        })
        .catch(err => {
            console.error("Login Error:", err);
            alert("Login failed. Please try again.");
        });
    });

    // üîÅ Check Session Status
    function updateNavbar() {
        fetch("http://localhost:3000/check-session", {
            credentials: "include" // ‚úÖ Essential
        })
        .then(response => response.json())
        .then(data => {
            const loginLink = document.getElementById("login-link");

            if (data.loggedIn) {
                loginLink.textContent = `Welcome, ${data.username}`;
                loginLink.style.cursor = "pointer";
                loginLink.setAttribute('title', 'Click to logout');
                
                // ‚úÖ Logout functionality
                loginLink.onclick = function (e) {
                    e.preventDefault();
                    if (confirm("Are you sure you want to logout?")) {
                        fetch("http://localhost:3000/logout", {
                            method: "POST",
                            credentials: "include"
                        })
                        .then(response => response.json())
                        .then(data => {
                            alert(data.message);
                            updateNavbar(); // Update UI
                        })
                        .catch(err => {
                            console.error("Logout error:", err);
                        });
                    }
                };
            } else {
                loginLink.textContent = "login";
                loginLink.removeAttribute("title");
                loginLink.onclick = function(e) {
                    e.preventDefault();
                    document.querySelector('.contaner').style.display = 'none';
                    document.getElementById('login-container').style.display = 'flex';
                    document.getElementById('signup-container').style.display = 'none';
                };
            }
        })
        .catch(err => {
            console.error("Session check error:", err);
        });
    }

    // üîÅ Initialize on page load
    document.addEventListener('DOMContentLoaded', function() {
        updateNavbar();
    });
</script>


</html>